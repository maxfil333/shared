<mxfile host="app.diagrams.net" modified="2024-03-13T11:16:47.371Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36" etag="BdxoV2Rcg6Ygwxb0bP4o" version="24.0.4" type="github">
  <diagram name="Страница — 1" id="la5cO36zwQWxTpJ-C7PE">
    <mxGraphModel dx="3512" dy="1440" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="jAn2KmhTPxv43Cljfc9A-4" value="&lt;h1&gt;L1, L2 норма вектора&lt;/h1&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;Манхэттенская норма L1 :&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;l1(v) = ||v||1 = |a1| + |a2| + |a3|&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;a = np.array([1,2,3]) // norm(a, 1) = 6&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;евклидова норма L2 :&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;l2(v) = ||v||2 = sqrt(a1^2 + a2^2 + a3^2)&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;a = np.array([1,2,3]) // norm(a, 2) = 3.74&lt;/font&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-145.5" y="-157" width="323" height="285" as="geometry" />
        </mxCell>
        <mxCell id="jAn2KmhTPxv43Cljfc9A-11" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-371" y="57" width="792" height="707" as="geometry" />
        </mxCell>
        <mxCell id="jAn2KmhTPxv43Cljfc9A-2" value="&lt;h1&gt;Скалярное произведение векторов&lt;/h1&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;p&gt;U (u1, u2) - вектор 1&lt;/p&gt;&lt;p&gt;V (v1, v2) - вектор 2&lt;/p&gt;&lt;p&gt;U * V = u1*v1 + u2*v2&lt;/p&gt;&lt;p style=&quot;text-align: justify;&quot;&gt;Применяя этот метод, надо помнить о&amp;nbsp;том, что&amp;nbsp;скалярное произведение очень сильно зависит от&amp;nbsp;длины векторов. Оно применимо только для&amp;nbsp;сравнения схожести векторов, имеющих одинаковую длину.&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;text-align: justify;&quot;&gt;Чем оно больше, тем больше похожи вектора.&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="jAn2KmhTPxv43Cljfc9A-11" vertex="1">
          <mxGeometry x="17" y="88" width="190" height="436" as="geometry" />
        </mxCell>
        <mxCell id="jAn2KmhTPxv43Cljfc9A-3" value="&lt;h1&gt;Косинусный коэффициент&lt;br&gt;векторов&lt;/h1&gt;&lt;p&gt;S = U * V / ( ||U|| * ||V||) ,&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;где:&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp;U * V - скалярное произведение векторов&lt;br&gt;&amp;nbsp;||U|| - длина вектора U = sqrt(u1**2 + u2**2)&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Вычисляют, находя косинус угла между двумя векторами. Чем этот коэффициент больше&amp;nbsp;— тем сильнее векторы похожи друг на&amp;nbsp;друга. Формула для&amp;nbsp;вычисления этого коэффициента предусматривает вычисление скалярного произведения векторов, которое делят на&amp;nbsp;произведение длин векторов.&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Это дополнение формулы скалярного произведения, нормализующее результаты, позволяет эффективно измерять схожесть векторов, учитывая их направления и не&amp;nbsp;обращая внимания на&amp;nbsp;их длины.&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: justify;&quot;&gt;При работе с единичными векторами, их скалярное произведение и косинусный коэффициент дают в точности одинаковые результаты.&lt;/p&gt;&lt;p style=&quot;text-align: justify;&quot;&gt;КОСИНУСНОЕ РАССТОЯНИЕ:&lt;/p&gt;&lt;p style=&quot;text-align: justify;&quot;&gt;1 - S&lt;/p&gt;&lt;p style=&quot;text-align: justify;&quot;&gt;Чем меньше, тем более похожи два вектора&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="jAn2KmhTPxv43Cljfc9A-11" vertex="1">
          <mxGeometry x="217" y="88" width="280" height="619" as="geometry" />
        </mxCell>
        <mxCell id="jAn2KmhTPxv43Cljfc9A-8" value="&lt;h1&gt;Евклидово расстояние&lt;/h1&gt;&lt;p&gt;Чем меньше евклидово расстояние между двумя векторами, тем они более похожи.&lt;/p&gt;&lt;p style=&quot;border-color: var(--border-color);&quot;&gt;U (u1, u2) - вектор 1&lt;/p&gt;&lt;p style=&quot;border-color: var(--border-color);&quot;&gt;V (v1, v2) - вектор 2&lt;/p&gt;&lt;p style=&quot;border-color: var(--border-color);&quot;&gt;d(U, V) = sqrt ( (u1 - v1)^2 + (u2 - v2)^2 )&lt;/p&gt;&lt;p style=&quot;border-color: var(--border-color);&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;text-align: justify; border-color: var(--border-color);&quot;&gt;В&amp;nbsp;отличие от&amp;nbsp;косинусного коэффициента, при&amp;nbsp;вычислении евклидового расстояния во&amp;nbsp;внимание принимаются длина и направление векторов.&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="jAn2KmhTPxv43Cljfc9A-11" vertex="1">
          <mxGeometry x="506" y="88" width="259" height="361" as="geometry" />
        </mxCell>
        <mxCell id="jAn2KmhTPxv43Cljfc9A-10" value="" style="swimlane;startSize=0;" parent="jAn2KmhTPxv43Cljfc9A-11" vertex="1">
          <mxGeometry y="80" width="776" height="498" as="geometry" />
        </mxCell>
        <mxCell id="ZfBfhqL-bQsjwtxrd6Du-7" value="&lt;ul style=&quot;transition: opacity 0.2s ease-in-out 0s, color 0.2s ease-in-out 0s, text-decoration 0.2s ease-in-out 0s, background-color 0.2s ease-in-out 0s, -webkit-text-decoration 0.2s ease-in-out 0s; quotes: &amp;quot;«&amp;quot; &amp;quot;»&amp;quot;; padding-inline-start: 32px; margin-top: 32px; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif; text-align: start; font-size: 11px; line-height: 90%;&quot;&gt;&lt;li style=&quot;transition: opacity 0.2s ease-in-out 0s, color 0.2s ease-in-out 0s, text-decoration 0.2s ease-in-out 0s, background-color 0.2s ease-in-out 0s, -webkit-text-decoration 0.2s ease-in-out 0s; quotes: &amp;quot;«&amp;quot; &amp;quot;»&amp;quot;; line-height: 1.5rem; margin: 0px 0px 6px; padding: 0px;&quot;&gt;&lt;p style=&quot;text-align: justify; transition: opacity 0.2s ease-in-out 0s, color 0.2s ease-in-out 0s, text-decoration 0.2s ease-in-out 0s, background-color 0.2s ease-in-out 0s, -webkit-text-decoration 0.2s ease-in-out 0s; quotes: &amp;quot;«&amp;quot; &amp;quot;»&amp;quot;; margin: 0px; padding: 0px; line-height: 90%;&quot;&gt;Если ваши эмбеддинги имеют разную длину, и вы хотите учитывать их длину при&amp;nbsp;определении их схожести, тогда лучше всего будет выбрать евклидово расстояние между векторами, так как&amp;nbsp;при&amp;nbsp;его вычислении учитывается и длина векторов, и их направление.&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;transition: opacity 0.2s ease-in-out 0s, color 0.2s ease-in-out 0s, text-decoration 0.2s ease-in-out 0s, background-color 0.2s ease-in-out 0s, -webkit-text-decoration 0.2s ease-in-out 0s; quotes: &amp;quot;«&amp;quot; &amp;quot;»&amp;quot;; line-height: 1.5rem; margin: 12px 0px 0px; padding: 0px;&quot;&gt;&lt;p style=&quot;text-align: justify; transition: opacity 0.2s ease-in-out 0s, color 0.2s ease-in-out 0s, text-decoration 0.2s ease-in-out 0s, background-color 0.2s ease-in-out 0s, -webkit-text-decoration 0.2s ease-in-out 0s; quotes: &amp;quot;«&amp;quot; &amp;quot;»&amp;quot;; margin: 0px; padding: 0px; line-height: 90%;&quot;&gt;Если все ваши эмбеддинги нормализованы, приведены к&amp;nbsp;единичной длине, тогда все три рассмотренных нами подхода дадут, как&amp;nbsp;вы уже видели, схожие результаты. Но&amp;nbsp;при&amp;nbsp;этом скалярное произведение векторов вычисляется&amp;nbsp;быстрее.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="jAn2KmhTPxv43Cljfc9A-10" vertex="1">
          <mxGeometry x="515" y="294" width="253" height="194" as="geometry" />
        </mxCell>
        <mxCell id="qhmzDrhK_W-VR-xvDRKj-1" value="&lt;pre style=&quot;box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: inherit; word-break: break-all; overflow-wrap: break-word; border: 0px; border-radius: 0px; vertical-align: baseline; text-align: left;&quot;&gt;&lt;pre style=&quot;border: 0px; box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: inherit; word-break: break-all; overflow-wrap: break-word; border-radius: 0px; vertical-align: baseline;&quot;&gt;&lt;pre style=&quot;border: 0px; box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: inherit; word-break: break-all; overflow-wrap: break-word; border-radius: 0px; vertical-align: baseline; font-size: 11px;&quot;&gt;&lt;pre style=&quot;border: 0px; box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: 80%; word-break: break-all; overflow-wrap: break-word; border-radius: 0px; vertical-align: baseline;&quot;&gt;&lt;pre style=&quot;box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: 80%; word-break: break-all; overflow-wrap: break-word; border: 0px; border-radius: 0px; vertical-align: baseline;&quot;&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;скалярное произв. 263.0&lt;br&gt;косинусный коэфф. 1.0&lt;br&gt;евклидово расст.  29.01&lt;/font&gt;&lt;/pre&gt;&lt;pre style=&quot;box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: 80%; word-break: break-all; overflow-wrap: break-word; border: 0px; border-radius: 0px; vertical-align: baseline;&quot;&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre style=&quot;box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: 80%; word-break: break-all; overflow-wrap: break-word; border: 0px; border-radius: 0px; vertical-align: baseline;&quot;&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;&lt;pre style=&quot;box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: inherit; word-break: break-all; overflow-wrap: break-word; border: 0px; border-radius: 0px; vertical-align: baseline;&quot;&gt;скалярное произв. 26.3&lt;br&gt;косинусный коэфф. 1.0&lt;br&gt;евклидово расст.  35.53&lt;/pre&gt;&lt;pre style=&quot;box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: inherit; word-break: break-all; overflow-wrap: break-word; border: 0px; border-radius: 0px; vertical-align: baseline;&quot;&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre style=&quot;box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: inherit; word-break: break-all; overflow-wrap: break-word; border: 0px; border-radius: 0px; vertical-align: baseline;&quot;&gt;&lt;pre style=&quot;box-sizing: border-box; overflow: auto; padding: 1px 0px; margin-top: 0px; margin-bottom: 0px; line-height: inherit; word-break: break-all; overflow-wrap: break-word; border: 0px; border-radius: 0px; vertical-align: baseline;&quot;&gt;скалярное произв. 32875&lt;br/&gt;косинусный коэфф. 1.0&lt;br/&gt;евклидово расст.  870.31&lt;/pre&gt;&lt;/pre&gt;&lt;/font&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="421" y="157" width="203" height="136" as="geometry" />
        </mxCell>
        <mxCell id="qhmzDrhK_W-VR-xvDRKj-4" value="&lt;div style=&quot;text-align: justify;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;При косинусном коэффициенте похожести равном 1.0 (идеально похожие (сонаправленные) векторы) евклидово расстояние может быть различным, т.к. эти векторы хоть и накладываются друг на друга, но могут быть разной длины. При одинаковой длине векторов евклидово расстояние равно 0.&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="421" y="303" width="201" height="154" as="geometry" />
        </mxCell>
        <mxCell id="zRfYUfufBy_Ly8vp8FLd-1" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1415" y="-164" width="998" height="1110" as="geometry" />
        </mxCell>
        <mxCell id="zRfYUfufBy_Ly8vp8FLd-4" value="&lt;font style=&quot;font-size: 24px;&quot;&gt;&lt;b&gt;pytorch&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-1406" y="-155" width="137" height="47" as="geometry" />
        </mxCell>
        <mxCell id="zRfYUfufBy_Ly8vp8FLd-5" value="&lt;pre style=&quot;line-height: 16.25px; padding: 0 var(--jp-code-padding); color: rgb(33, 33, 33); text-align: start; font-size: 13px;&quot;&gt;&lt;font face=&quot;Verdana&quot; style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;&lt;i&gt;DATASETS&lt;/i&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre style=&quot;line-height: 16.25px; padding: 0 var(--jp-code-padding); color: rgb(33, 33, 33); text-align: start; font-size: 13px;&quot;&gt;&lt;font face=&quot;Verdana&quot; style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;tensor_X_train&lt;/span&gt; &lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); font-weight: bold;&quot; class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;&quot; class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); font-weight: bold;&quot; class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color);&quot; class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color);&quot; class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); font-weight: bold;&quot; class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color);&quot; class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); font-weight: bold;&quot; class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color);&quot; class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre style=&quot;line-height: 16.25px; padding: 0 var(--jp-code-padding); color: rgb(33, 33, 33); text-align: start; font-size: 13px;&quot;&gt;&lt;font face=&quot;Verdana&quot; style=&quot;font-size: 13px;&quot;&gt;train_dataset&lt;span style=&quot;background-color: initial; white-space: normal;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); background-color: initial; white-space: normal; font-weight: bold;&quot; class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;background-color: initial; white-space: normal;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;background-color: initial; white-space: normal;&quot; class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); background-color: initial; white-space: normal; font-weight: bold;&quot; class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;background-color: initial; white-space: normal;&quot; class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); background-color: initial; white-space: normal; font-weight: bold;&quot; class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;background-color: initial; white-space: normal;&quot; class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); background-color: initial; white-space: normal; font-weight: bold;&quot; class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;background-color: initial; white-space: normal;&quot; class=&quot;n&quot;&gt;TensorDataset&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color); background-color: initial; white-space: normal;&quot; class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;background-color: initial; white-space: normal;&quot; class=&quot;n&quot;&gt;tensor_X_train&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color); background-color: initial; white-space: normal;&quot; class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;background-color: initial; white-space: normal;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;background-color: initial; white-space: normal;&quot; class=&quot;n&quot;&gt;tensor_y_train&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color); background-color: initial; white-space: normal;&quot; class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre style=&quot;line-height: 16.25px; padding: 0 var(--jp-code-padding); color: rgb(33, 33, 33); text-align: start; font-size: 13px;&quot;&gt;&lt;pre style=&quot;line-height: 16.25px; padding: 0 var(--jp-code-padding);&quot;&gt;&lt;font face=&quot;Verdana&quot; style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;train_dataloader&lt;/span&gt; &lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); font-weight: bold;&quot; class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;&quot; class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); font-weight: bold;&quot; class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); font-weight: bold;&quot; class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); font-weight: bold;&quot; class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color);&quot; class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot; class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color);&quot; class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span style=&quot;&quot; class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); font-weight: bold;&quot; class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-number-color);&quot; class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color);&quot; class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span style=&quot;&quot; class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-operator-color); font-weight: bold;&quot; class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-keyword-color); font-weight: bold;&quot; class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span style=&quot;color: var(--jp-mirror-editor-punctuation-color);&quot; class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;/pre&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#CCCCCC;fillStyle=hatch;strokeColor=default;" parent="1" vertex="1">
          <mxGeometry x="-1406" y="-108" width="685" height="159" as="geometry" />
        </mxCell>
        <mxCell id="fqMix3vTBiJLlRPKZ0KL-1" value="&lt;pre style=&quot;line-height: 90%; padding: 0 var(--jp-code-padding); color: rgb(33, 33, 33); text-align: start; font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot; face=&quot;Verdana&quot;&gt;&lt;i style=&quot;&quot;&gt;SHOW GRADIENTS&lt;/i&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre style=&quot;line-height: 90%; padding: 0 var(--jp-code-padding); text-align: start; font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot; face=&quot;Verdana&quot;&gt;&lt;i style=&quot;&quot;&gt;&lt;font color=&quot;#212121&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;import torch&lt;br&gt;import torch.nn as nn&lt;br&gt;&lt;br&gt;# Определение модели&lt;br&gt;class MyModel(nn.Module):&lt;br&gt;    def __init__(self):&lt;br&gt;        super(MyModel, self).__init__()&lt;br&gt;        self.fc1 = nn.Linear(10, 5)&lt;br&gt;        self.fc2 = nn.Linear(5, 3)&lt;br&gt;        self.fc3 = nn.Linear(3, 1)&lt;br&gt;&lt;br&gt;    def forward(self, x):&lt;br&gt;        x = torch.relu(self.fc1(x))&lt;br&gt;        x = torch.relu(self.fc2(x))&lt;br&gt;        x = self.fc3(x)&lt;br&gt;        return x&lt;br&gt;&lt;br&gt;# Создание экземпляра модели&lt;br&gt;model = MyModel()&lt;br&gt;&lt;br&gt;# Произвольные данные&lt;br&gt;input_data = torch.randn(1, 10)&lt;br&gt;target = torch.randn(1, 1)&lt;br&gt;&lt;br&gt;# Определение функции потерь&lt;br&gt;criterion = nn.MSELoss()&lt;br&gt;&lt;br&gt;# Производим прямой проход&lt;br&gt;output = model(input_data)&lt;br&gt;&lt;br&gt;# Вычисляем значение функции потерь&lt;br&gt;loss = criterion(output, target)&lt;br&gt;&lt;br&gt;# Обнуляем градиенты перед обратным проходом&lt;br&gt;model.zero_grad()&lt;br&gt;&lt;br&gt;# Производим обратный проход (обратное распространение градиентов)&lt;br&gt;loss.backward()&lt;br&gt;&lt;br&gt;# Получаем градиенты&lt;br&gt;for name, param in model.named_parameters():&lt;br&gt;    print(name, param.grad)&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/i&gt;&lt;/font&gt;&lt;/pre&gt;&lt;div style=&quot;text-align: start; line-height: 90%;&quot;&gt;&lt;font face=&quot;Verdana&quot;&gt;&lt;i&gt;&lt;br&gt;&lt;/i&gt;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#FFFF99;fillStyle=hatch;strokeColor=default;" vertex="1" parent="1">
          <mxGeometry x="-1406" y="60" width="574" height="662" as="geometry" />
        </mxCell>
        <mxCell id="fqMix3vTBiJLlRPKZ0KL-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="fqMix3vTBiJLlRPKZ0KL-1" target="fqMix3vTBiJLlRPKZ0KL-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
